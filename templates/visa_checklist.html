{% extends "dashboard_updated.html" %}

{% block title %}Visa Checklist - UniCounsel{% endblock %}

{% block dashboard_content %}
<style>
    .requirement-item { padding: 1rem; background: rgba(100, 200, 255, 0.05); border-left: 4px solid #64c8ff; border-radius: 6px; transition: all 0.3s; margin-bottom: 0.75rem; }
    .requirement-item.completed { background: rgba(52, 211, 153, 0.05); border-left-color: #34d399; }
    .requirement-item input[type="checkbox"]:checked ~ .requirement-content { opacity: 0.6; }
    .requirement-content { flex: 1; }
    .importance-critical { color: #ef4444; }
    .importance-high { color: #fb923c; }
    .importance-medium { color: #f59e0b; }
    .timeline-step { padding: 1.5rem; background: rgba(100, 200, 255, 0.05); border-left: 4px solid #64c8ff; border-radius: 6px; position: relative; margin-bottom: 1rem; }
    .timeline-step::before { content: ''; position: absolute; left: -2px; top: -20px; width: 4px; height: 20px; background: linear-gradient(to bottom, #64c8ff, transparent); }
    .timeline-step:first-child::before { display: none; }
    .progress-ring { width: 80px; height: 80px; border-radius: 50%; background: conic-gradient(#34d399 var(--progress), rgba(52, 211, 153, 0.2) 0); display: flex; align-items: center; justify-content: center; }
    .progress-text { font-size: 1.75rem; font-weight: bold; color: #34d399; }
    .visa-type-card { padding: 1.5rem; background: linear-gradient(135deg, rgba(100, 200, 255, 0.1), rgba(52, 211, 153, 0.05)); border: 1px solid rgba(100, 200, 255, 0.2); border-radius: 8px; }
    .key-dates { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; }
    .date-card { padding: 1rem; background: rgba(100, 200, 255, 0.05); border-radius: 6px; text-align: center; }
    .date-event { font-weight: bold; color: #64c8ff; margin-bottom: 0.5rem; }
    .date-value { color: #999; font-size: 0.875rem; }
    .contact-card { padding: 1.5rem; background: rgba(100, 200, 255, 0.05); border-radius: 8px; }
    .checklist-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; }
</style>

<div class="space-y-8">
    <div>
        <h1 class="text-4xl font-bold mb-2">
            <i class="fas fa-passport mr-3 text-primary"></i>Visa Checklist & Timeline
        </h1>
        <p class="text-muted">Complete visa application guide with documentation checklist and key dates</p>
    </div>
    
    <!-- Country Selection -->
    <div class="card">
        <h2 class="text-xl font-bold mb-4">Select Your Destination Country</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium mb-2">Country</label>
                <select id="visaCountry" class="w-full border border-border rounded-lg px-4 py-3 text-white focus:outline-none focus:border-primary" style="background-color: #1a1f35;">
                    <option value="">-- Select Country --</option>
                    <option value="Australia">Australia</option>
                    <option value="Ethiopia">Ethiopia</option>
                </select>
            </div>
        </div>
    </div>
    
    <!-- Visa Information Section (Hidden by default) -->
    <div id="visaSection" style="display: none;" class="space-y-8">
        
        <!-- Visa Type Card -->
        <div class="card">
            <div class="visa-type-card">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-lg font-bold text-primary mb-3">Visa Details</h3>
                        <div class="space-y-2">
                            <div>
                                <div class="text-xs text-muted">Visa Type</div>
                                <div class="font-bold" id="visaType">Student Visa</div>
                            </div>
                            <div>
                                <div class="text-xs text-muted">Processing Time</div>
                                <div class="font-bold" id="processingTime">1-3 months</div>
                            </div>
                            <div>
                                <div class="text-xs text-muted">Validity Period</div>
                                <div class="font-bold" id="validity">5 years</div>
                            </div>
                            <div>
                                <div class="text-xs text-muted">Application Fee</div>
                                <div class="font-bold" id="cost">AUD 550</div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-primary mb-3">Work Rights & Benefits</h3>
                        <ul class="space-y-2 text-sm">
                            <li><i class="fas fa-check text-green-400 mr-2"></i><span id="workRights">Can work up to 20 hours/week during study</span></li>
                            <li><i class="fas fa-check text-green-400 mr-2"></i><span id="familyBenefits">Can bring dependents</span></li>
                            <li><i class="fas fa-check text-green-400 mr-2"></i><span id="postStudy">Post-study work visa available for 2-5 years</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Progress Tracker -->
        <div class="card">
            <h2 class="text-2xl font-bold mb-6">
                <i class="fas fa-clipboard-check mr-2"></i>Application Progress
            </h2>
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h3 class="font-bold">Completion Status</h3>
                    <p class="text-sm text-muted">Track your progress</p>
                </div>
                <div class="progress-ring" id="progressRing" style="--progress: 0%;">
                    <span class="progress-text" id="progressText">0%</span>
                </div>
            </div>
        </div>
        
        <!-- Requirements Checklist -->
        <div class="card">
            <h2 class="text-2xl font-bold mb-6">
                <i class="fas fa-list-check mr-2"></i>Documentation Requirements
            </h2>
            <div id="requirementsChecklist" class="space-y-3">
                <!-- Populated by JS -->
            </div>
        </div>
        
        <!-- Timeline -->
        <div class="card">
            <h2 class="text-2xl font-bold mb-6">
                <i class="fas fa-timeline mr-2"></i>Visa Application Timeline
            </h2>
            <div id="timelineContainer">
                <!-- Populated by JS -->
            </div>
        </div>
        
        <!-- Key Dates -->
        <div class="card">
            <h2 class="text-2xl font-bold mb-6">
                <i class="fas fa-calendar mr-2"></i>Important Dates
            </h2>
            <div class="key-dates" id="keyDatesContainer">
                <!-- Populated by JS -->
            </div>
        </div>
        
        <!-- Contact Information -->
        <div class="card">
            <h2 class="text-2xl font-bold mb-6">
                <i class="fas fa-phone mr-2"></i>Official Contacts
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="contact-card">
                    <h3 class="font-bold text-primary mb-2">Embassy/High Commission</h3>
                    <div id="embassyInfo">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <div class="contact-card">
                    <h3 class="font-bold text-primary mb-2">Additional Resources</h3>
                    <ul class="text-sm space-y-2" id="additionalResources">
                        <!-- Populated by JS -->
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Tips & Recommendations -->
        <div class="card glow-border" style="background: linear-gradient(135deg, rgba(52, 211, 153, 0.1), rgba(100, 200, 255, 0.05));">
            <h2 class="text-2xl font-bold mb-6">
                <i class="fas fa-lightbulb mr-2"></i>Tips for Successful Visa Application
            </h2>
            <ul class="space-y-3 text-sm">
                <li><i class="fas fa-star text-amber-400 mr-2"></i><strong>Apply Early:</strong> Submit your visa application at least 3-4 months before your intended travel date</li>
                <li><i class="fas fa-star text-amber-400 mr-2"></i><strong>Complete Documentation:</strong> Ensure all documents are original and properly certified</li>
                <li><i class="fas fa-star text-amber-400 mr-2"></i><strong>Financial Proof:</strong> Show genuine funds for tuition and living expenses for the entire duration</li>
                <li><i class="fas fa-star text-amber-400 mr-2"></i><strong>English Proficiency:</strong> Achieve required IELTS/TOEFL scores well in advance</li>
                <li><i class="fas fa-star text-amber-400 mr-2"></i><strong>Medical Examination:</strong> Complete health checks at approved centers</li>
                <li><i class="fas fa-star text-amber-400 mr-2"></i><strong>Insurance:</strong> Purchase international student health insurance before travel</li>
            </ul>
        </div>
    </div>
</div>

<script>
    const visaDataDB = {
        'Australia': {
            'visa_type': 'Student Visa (Subclass 500)',
            'processing_time': '1-3 months',
            'validity': '5 years',
            'cost': 'AUD 550',
            'work_rights': 'Can work up to 20 hours/week during study, full-time during breaks',
            'family_members': 'Can bring dependents',
            'post_study': 'Post-study work visa available for 2-5 years depending on qualification',
            'requirements': [
                {'item': 'Valid Passport', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'Confirmed Enrollment Letter', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'IELTS/TOEFL Score', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'Financial Evidence (AUD 50K+)', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'Medical Certificate (Form I693)', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'Police Clearance', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'Purpose of Stay Letter', 'status': 'Recommended', 'importance': 'High'},
                {'item': 'Bank Statements (6 months)', 'status': 'Mandatory', 'importance': 'High'},
                {'item': 'Tax Records', 'status': 'If applicable', 'importance': 'Medium'},
                {'item': 'Travel Insurance', 'status': 'Recommended', 'importance': 'Medium'},
            ],
            'key_dates': [
                {'event': 'Application Opens', 'date': '2024-01-01'},
                {'event': 'Recommended Deadline', 'date': '2024-06-30'},
                {'event': 'Processing Begins', 'date': 'Upon Complete Submission'},
                {'event': 'Typical Decision', 'date': '6-12 weeks'},
            ],
            'contacts': {
                'embassy': 'Australian High Commission',
                'website': 'immi.homeaffairs.gov.au',
                'helpline': '+61-2-6261-3305'
            }
        },
        'Ethiopia': {
            'visa_type': 'Student Visa',
            'processing_time': '2-4 weeks',
            'validity': '1 year',
            'cost': 'Variable by nationality',
            'work_rights': 'Part-time work may be allowed with special permission',
            'family_members': 'Dependents possible with additional documents',
            'post_study': 'Work visa options available',
            'requirements': [
                {'item': 'Valid Passport', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'Enrollment Letter', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'Financial Proof', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'Medical Certificate', 'status': 'Required', 'importance': 'Critical'},
                {'item': 'Police Clearance', 'status': 'Recommended', 'importance': 'High'},
                {'item': 'Yellow Fever Vaccination', 'status': 'Mandatory', 'importance': 'Critical'},
                {'item': 'Travel Insurance', 'status': 'Recommended', 'importance': 'Medium'},
                {'item': 'Bank Statements', 'status': 'Recommended', 'importance': 'High'},
            ],
            'key_dates': [
                {'event': 'Application Opens', 'date': '2024-01-15'},
                {'event': 'Submission Deadline', 'date': '2024-07-15'},
                {'event': 'Initial Review', 'date': '1-2 weeks'},
                {'event': 'Approval Decision', 'date': '2-4 weeks'},
            ],
            'contacts': {
                'embassy': 'Ethiopian Immigration Office',
                'website': 'immigration.gov.et',
                'helpline': '+251-11-123-4567'
            }
        }
    };
    
    document.getElementById('visaCountry').addEventListener('change', function() {
        const country = this.value;
        
        if (!country) {
            document.getElementById('visaSection').style.display = 'none';
            return;
        }
        
        const data = visaDataDB[country];
        if (!data) return;
        
        // Update visa details
        document.getElementById('visaType').textContent = data.visa_type;
        document.getElementById('processingTime').textContent = data.processing_time;
        document.getElementById('validity').textContent = data.validity;
        document.getElementById('cost').textContent = data.cost;
        document.getElementById('workRights').textContent = data.work_rights;
        document.getElementById('familyBenefits').textContent = data.family_members;
        document.getElementById('postStudy').textContent = data.post_study;
        
        // Render requirements
        let completedCount = 0;
        const requirementsHtml = data.requirements.map((req, idx) => `
            <label class="requirement-item flex items-center cursor-pointer">
                <input type="checkbox" class="w-5 h-5 mr-3 requirement-checkbox">
                <div class="requirement-content">
                    <div class="font-bold flex items-center">
                        ${req.item}
                        <span class="importance-${req.importance.toLowerCase()} text-xs ml-2">${req.importance}</span>
                    </div>
                    <div class="text-xs text-muted mt-1">Status: ${req.status}</div>
                </div>
            </label>
        `).join('');
        document.getElementById('requirementsChecklist').innerHTML = requirementsHtml;
        
        // Add checkbox listeners for progress tracking
        document.querySelectorAll('.requirement-checkbox').forEach((checkbox, idx) => {
            checkbox.addEventListener('change', updateProgress);
        });
        
        // Timeline
        const timelineHtml = data.key_dates.map((d, idx) => `
            <div class="timeline-step">
                <div class="font-bold text-primary">${d.event}</div>
                <div class="text-sm text-muted mt-1">${d.date}</div>
            </div>
        `).join('');
        document.getElementById('timelineContainer').innerHTML = timelineHtml;
        
        // Key dates
        const datesHtml = data.key_dates.map(d => `
            <div class="date-card">
                <div class="date-event">${d.event}</div>
                <div class="date-value">${d.date}</div>
            </div>
        `).join('');
        document.getElementById('keyDatesContainer').innerHTML = datesHtml;
        
        // Contacts
        document.getElementById('embassyInfo').innerHTML = `
            <div class="text-sm"><strong>${data.contacts.embassy}</strong></div>
            <div class="text-xs text-muted mt-2">Website: ${data.contacts.website}</div>
            <div class="text-xs text-muted">Helpline: ${data.contacts.helpline}</div>
        `;
        
        document.getElementById('additionalResources').innerHTML = `
            <li><i class="fas fa-globe mr-2"></i>Visit official immigration website</li>
            <li><i class="fas fa-phone mr-2"></i>Contact visa office via email/phone</li>
            <li><i class="fas fa-map-location-dot mr-2"></i>Schedule appointment at visa center</li>
            <li><i class="fas fa-document mr-2"></i>Prepare all required documents</li>
        `;
        
        document.getElementById('visaSection').style.display = 'block';
        document.getElementById('visaSection').scrollIntoView({ behavior: 'smooth' });
        updateProgress();
    });
    
    function updateProgress() {
        const checkboxes = document.querySelectorAll('.requirement-checkbox');
        const checked = document.querySelectorAll('.requirement-checkbox:checked').length;
        const progress = Math.round((checked / checkboxes.length) * 100) || 0;
        
        document.getElementById('progressText').textContent = progress + '%';
        document.getElementById('progressRing').style.setProperty('--progress', progress + '%');
    }
</script>
{% endblock %}
